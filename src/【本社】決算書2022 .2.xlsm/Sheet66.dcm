VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
END
Attribute VB_Name = "Sheet66"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Dim i, k, c1, c2 As Integer
Dim syo As Integer
Dim cnt1, sum As Long
Dim t, a As String
Dim myRange As Range

Private Sub CommandButton1_Click()
    
    c1 = 0
    c2 = 0
    k = 0
    syo = 0
    sum = 0
    t = ""
    a = ""
    
    Application.DisplayAlerts = False
    
    Set myRange = Range("H5:H500")

    cnt1 = WorksheetFunction.Count(myRange)
     
    syo = Application.RoundUp(cnt1 / 50, 0)
      
    k = 0
    
    'あらかじめ現在のシートを削除
    For i = 1 To 10
    
        If SheetDetect("原材料" & "(" & i & ")") Then
                
            Worksheets("原材料" & "(" & i & ")").Delete

        End If
    
    Next
               
    For i = 1 To syo
    
    If k = 0 Then
            
        Worksheets("原材料").Copy After:=Worksheets("原材料データ")
        ActiveSheet.Name = "原材料" & "(" & i & ")"
        k = 1
        
    Else
        
        Worksheets("原材料").Copy After:=Worksheets("原材料" & "(" & i - 1 & ")")
        ActiveSheet.Name = "原材料" & "(" & i & ")"
    
    End If
        
    c1 = (i - 1) * 50 + 5
    c2 = i * 50 + 4
        
        Worksheets("原材料データ").Range(Cells(c1, 1), Cells(c2, 8)).Copy
        Worksheets("原材料" & "(" & i & ")").Range("A5").PasteSpecial Paste:=xlValues
        
        sum = sum + Worksheets("原材料" & "(" & i & ")").Range("H55").Value
        
        'タイトル№変換
        a = Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(i, "1", "Ⅰ"), "2", "Ⅱ"), "3", "Ⅲ"), "4", "Ⅳ"), "5", "Ⅴ"), "6", "Ⅵ"), "7", "Ⅶ"), "8", "Ⅷ"), "9", "Ⅸ"), "10", "Ⅹ")
        t = Worksheets("原材料").Range("A1").Value & a
        
        Worksheets("原材料" & "(" & i & ")").Range("A1").Value = t
        
        If i = syo And i <> 1 Then
        
        Worksheets("原材料" & "(" & i & ")").Range("H56").Value = sum
        
        Else
        
        '総合計セルのクリア
        Worksheets("原材料" & "(" & i & ")").Range("A56:H56").ClearFormats
        Worksheets("原材料" & "(" & i & ")").Range("A56:H56").Clear
        Worksheets("原材料" & "(" & i & ")").Range("A56:H56").Borders(xlEdgeTop).LineStyle = xlContinuous
             
        End If
        
    Next



End Sub
